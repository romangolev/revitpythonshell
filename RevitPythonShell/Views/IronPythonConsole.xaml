<Window
    Height="600"
    MinHeight="400"
    MinWidth="300"
    Title="IronPython Console"
    Width="850"
    Background="{DynamicResource ThemeWindowBackground}"
    Foreground="{DynamicResource ThemeWindowForeground}"
    WindowStyle="None"
    ResizeMode="CanResize"
    AllowsTransparency="False"
    x:Class="RevitPythonShell.Views.IronPythonConsole"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
    xmlns:console="clr-namespace:PythonConsoleControl;assembly=PythonConsoleControl"
    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
	<!--
        Copyright (c) 2010 Joe Moorhouse
    -->
	<WindowChrome.WindowChrome>
		<shell:WindowChrome CaptionHeight="0" ResizeBorderThickness="6" CornerRadius="0" GlassFrameThickness="0" UseAeroCaptionButtons="False" />
	</WindowChrome.WindowChrome>

	<Window.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
                <!-- <ResourceDictionary Source="/RevitPythonShell;component/Themes/DarkTheme.xaml" /> -->

                <ResourceDictionary Source="/RevitPythonShell;component/Themes/LightTheme.xaml" />
			</ResourceDictionary.MergedDictionaries>

			<Style TargetType="{x:Type Ribbon}">
				<Setter Property="Background" Value="{DynamicResource ThemeRibbonBackground}" />
				<Setter Property="Foreground" Value="{DynamicResource ThemeRibbonForeground}" />
				<Setter Property="BorderBrush" Value="{DynamicResource ThemeRibbonBorder}" />
			</Style>

			<Style TargetType="{x:Type RibbonTab}">
				<Setter Property="Background" Value="{DynamicResource ThemeRibbonBackground}" />
				<Setter Property="Foreground" Value="{DynamicResource ThemeRibbonForeground}" />
				<Setter Property="BorderBrush" Value="{DynamicResource ThemeRibbonBorder}" />
				<Setter Property="Template">
					<Setter.Value>
						<ControlTemplate TargetType="{x:Type RibbonTab}">
							<Border Background="{TemplateBinding Background}"
									BorderBrush="{TemplateBinding BorderBrush}"
									BorderThickness="0,0,0,1"
									Padding="4">
								<ItemsPresenter />
							</Border>
						</ControlTemplate>
					</Setter.Value>
				</Setter>
			</Style>

			<Style TargetType="{x:Type RibbonTabHeader}">
				<Setter Property="Background" Value="{DynamicResource ThemeRibbonBackground}" />
				<Setter Property="Foreground" Value="{DynamicResource ThemeRibbonForeground}" />
				<Setter Property="BorderBrush" Value="{DynamicResource ThemeRibbonBorder}" />
				<Setter Property="Template">
					<Setter.Value>
						<ControlTemplate TargetType="{x:Type RibbonTabHeader}">
							<Border x:Name="TabBorder"
									Background="{TemplateBinding Background}"
									BorderBrush="{TemplateBinding BorderBrush}"
									BorderThickness="0,0,1,1"
									Padding="8,2">
								<ContentPresenter ContentSource="Content"
										HorizontalAlignment="Center"
										VerticalAlignment="Center" />
							</Border>
							<ControlTemplate.Triggers>
								<Trigger Property="IsMouseOver" Value="True">
									<Setter TargetName="TabBorder" Property="Background" Value="{DynamicResource ThemeRibbonBackground}" />
								</Trigger>
							</ControlTemplate.Triggers>
						</ControlTemplate>
					</Setter.Value>
				</Setter>
			</Style>

			<Style TargetType="{x:Type RibbonGroup}">
				<Setter Property="Background" Value="{DynamicResource ThemeRibbonBackground}" />
				<Setter Property="Foreground" Value="{DynamicResource ThemeRibbonForeground}" />
				<Setter Property="BorderBrush" Value="{DynamicResource ThemeRibbonBorder}" />
				<Setter Property="Height" Value="78" />
				<Setter Property="Template">
					<Setter.Value>
						<ControlTemplate TargetType="{x:Type RibbonGroup}">
							<Border Background="{TemplateBinding Background}"
									BorderBrush="{TemplateBinding BorderBrush}"
									BorderThickness="0,0,1,1"
									Padding="4">
								<DockPanel LastChildFill="True">
									<ContentPresenter ContentSource="Header"
											DockPanel.Dock="Bottom"
											HorizontalAlignment="Center"
											Margin="0,2,0,0" />
									<ItemsPresenter />
								</DockPanel>
							</Border>
						</ControlTemplate>
					</Setter.Value>
				</Setter>
			</Style>

			<Style TargetType="{x:Type GridSplitter}">
				<Setter Property="Background" Value="{DynamicResource ThemeGridSplitter}" />
				<Style.Triggers>
					<Trigger Property="IsMouseOver" Value="True">
						<Setter Property="Background" Value="{DynamicResource ThemeGridSplitterHover}" />
					</Trigger>
				</Style.Triggers>
			</Style>

			<Style x:Key="TitleBarButtonStyle" TargetType="{x:Type Button}">
				<Setter Property="Background" Value="Transparent" />
				<Setter Property="Foreground" Value="{DynamicResource ThemeTitleBarForeground}" />
				<Setter Property="BorderThickness" Value="0" />
				<Setter Property="Width" Value="46" />
				<Setter Property="Height" Value="40" />
				<Setter Property="FontFamily" Value="Segoe MDL2 Assets" />
				<Setter Property="FontSize" Value="12" />
				<Setter Property="Padding" Value="0" />
				<Setter Property="HorizontalContentAlignment" Value="Center" />
				<Setter Property="VerticalContentAlignment" Value="Center" />
				<Style.Triggers>
					<Trigger Property="IsMouseOver" Value="True">
						<Setter Property="Background" Value="{DynamicResource ThemeTitleBarButtonHover}" />
					</Trigger>
					<Trigger Property="IsPressed" Value="True">
						<Setter Property="Background" Value="{DynamicResource ThemeTitleBarButtonPressed}" />
					</Trigger>
				</Style.Triggers>
			</Style>

			<Style x:Key="TitleBarCloseButtonStyle" TargetType="{x:Type Button}" BasedOn="{StaticResource TitleBarButtonStyle}">
				<Style.Triggers>
					<Trigger Property="IsMouseOver" Value="True">
						<Setter Property="Background" Value="{DynamicResource ThemeTitleBarCloseHover}" />
						<Setter Property="Foreground" Value="{DynamicResource ThemeTitleBarCloseForeground}" />
					</Trigger>
					<Trigger Property="IsPressed" Value="True">
						<Setter Property="Background" Value="{DynamicResource ThemeTitleBarClosePressed}" />
						<Setter Property="Foreground" Value="{DynamicResource ThemeTitleBarCloseForeground}" />
					</Trigger>
				</Style.Triggers>
			</Style>
		</ResourceDictionary>
	</Window.Resources>

	<Grid Background="{DynamicResource ThemeWindowBackground}">
		<Grid.RowDefinitions>
			<RowDefinition Height="40" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="20*" />
			<RowDefinition Height="10" />
			<RowDefinition Height="12*" />
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="1*" />
			<ColumnDefinition Width="Auto" />
		</Grid.ColumnDefinitions>
		<DockPanel Grid.Column="0" Grid.Row="1" Background="{DynamicResource ThemeRibbonBackground}">
			<Ribbon Name="mainRibbon"
					Margin="0,-22,0,0" 
					KeyboardNavigation.TabIndex="0"
					ContextMenu="{x:Null}"
					AllowDrop="False">
				<Ribbon.Resources>
					<Style TargetType="{x:Type Image}">
						<Style.Triggers>
							<DataTrigger
                                Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ButtonBase}, AncestorLevel=1}, Path=IsEnabled}"
                                Value="False">
								<Setter Property="Opacity" Value="0.30" />
							</DataTrigger>
						</Style.Triggers>
					</Style>
				</Ribbon.Resources>
				<Ribbon.QuickAccessToolBar>
					<RibbonQuickAccessToolBar Visibility="Collapsed" Height="0" MinHeight="0" />
				</Ribbon.QuickAccessToolBar>
				<Ribbon.ApplicationMenu>
					<RibbonApplicationMenu Visibility="Collapsed">
					</RibbonApplicationMenu>
				</Ribbon.ApplicationMenu>
				<RibbonTab Header="Home" ContextMenu="{x:Null}">
					<RibbonGroup Header="File">
						<RibbonButton Label="New" LargeImageSource="../Resources/Theme/New.png"
                                      ToolTip="New (Ctrl + N)"
                                      SnapsToDevicePixels="True"
                                     Click="newFileClick" />
						<RibbonButton Label="Open" LargeImageSource="../Resources/Theme/Open.png"
                                      ToolTip="Open (Ctrl + O)"
                                      Click="openFileClick" />
						<RibbonButton Label="Save" LargeImageSource="../Resources/Theme/Save.png"
                                      ToolTip="Save (Ctrl + S)"
                                      Click="saveFileClick"
                                      SnapsToDevicePixels="True" />
						<RibbonButton Label="Save As" LargeImageSource="../Resources/Theme/SaveAs.png"
                                      ToolTip="Save As (Ctrl + Shift + S)"
                                      SnapsToDevicePixels="True"
                                      Click="saveAsFileClick" />
					</RibbonGroup>
					<RibbonGroup Header="Modify">
						<RibbonButton Label="Cut" SmallImageSource="../Resources/Theme/Cut.png"
                                      ToolTip="Cut Selected"
                                      SnapsToDevicePixels="True"
                                      Command="Cut" />
						<RibbonButton Label="Copy" SmallImageSource="../Resources/Theme/Save.png"
                                      ToolTip="Copy Selected"
                                      SnapsToDevicePixels="True"
                                      Command="Copy" />
						<RibbonButton Label="Paste" SmallImageSource="../Resources/Theme/Paste.png"
                                      ToolTip="Paste Into Script Editor"
                                      SnapsToDevicePixels="True"
                                      Command="Paste" />
					</RibbonGroup>
					<RibbonGroup Header="Edit">
						<RibbonToggleButton Label="Undo"
                                            SmallImageSource="../Resources/Theme/Undo.png"
                                            SnapsToDevicePixels="True"
                                            ToolTip="Undo"
                                            Command="Undo" />
						<RibbonButton Label="Redo" SmallImageSource="../Resources/Theme/Redo.png"
                                      ToolTip="Redo"
                                      SnapsToDevicePixels="True"
                                      Command="Redo" />
						<RibbonButton Label="Delete" SmallImageSource="../Resources/Theme/Delete.png"
                                      ToolTip="Delete Selected"
                                      SnapsToDevicePixels="True"
                                      Command="Delete" />
					</RibbonGroup>
					<RibbonGroup Header="Cell">
						<RibbonCheckBox Label="WordWrap" SmallImageSource="../Resources/Theme/WordWrap.png"
                                        ToolTip="Toggle Word Wrap"
                                        SnapsToDevicePixels="True"
                                        IsChecked="{Binding ElementName=textEditor, Path=WordWrap}" />
						<RibbonCheckBox Label="Paragraph" SmallImageSource="../Resources/Theme/Paragraph.png"
                                        ToolTip="Toggle Show End of Line"
                                        SnapsToDevicePixels="True"
                                        IsChecked="{Binding ElementName=textEditor, Path=Options.ShowEndOfLine}"
                                        />
						<RibbonCheckBox Label="Number" SmallImageSource="../Resources/Theme/Number.png"
                                        IsChecked="{Binding ElementName=textEditor, Path=ShowLineNumbers}"
                                        ToolTip="Toggle Line Numbers"
                                        SnapsToDevicePixels="True"/>
					</RibbonGroup>
					<RibbonGroup Header="Execute">
						<RibbonButton Label="Run" LargeImageSource="../Resources/Theme/Run.png"
                                      SnapsToDevicePixels="True"
                                      Click="runClick"
                                      ToolTip="(F5) Run Script. Results will be displayed in the IronPython prompt." />
					</RibbonGroup>
				</RibbonTab>
			</Ribbon>
			<!-- <ToolBar DockPanel.Dock="Top"> -->
			<!--     <Separator /> -->
			<!--     <CheckBox IsChecked="{Binding ElementName=textEditor, Path=ShowLineNumbers}"> -->
			<!--         <Image -->
			<!--             Height="16" -->
			<!--             SnapsToDevicePixels="True" -->
			<!--             Source="/RevitPythonShell;component/Resources/Theme/Number.png" -->
			<!--             ToolTip="Toggle Line Numbers" /> -->
			<!--     </CheckBox> -->
			<!-- </ToolBar> -->
		</DockPanel>
		<Grid Grid.Column="0" Grid.Row="2" Background="{DynamicResource ThemeEditorBackground}">
			<avalonEdit:TextEditor
                FontFamily="Consolas"
                FontSize="10pt"
                Background="{DynamicResource ThemeEditorBackground}"
                Foreground="{DynamicResource ThemeEditorForeground}"
                GotFocus="textEditor_GotFocus"
                Name="textEditor">
				# IronPython Pad. Write code snippets here and F5 to run.
			</avalonEdit:TextEditor>
		</Grid>
		<GridSplitter
            Grid.Row="3"
            Grid.Column="0"
            Height="10"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Center" />

		<Grid Grid.Row="4" MinHeight="20" Background="{DynamicResource ThemeConsoleBackground}">
			<console:IronPythonConsoleControl Name="consoleControl" />
		</Grid>
		<Border Grid.Column="0" Grid.Row="0" Panel.ZIndex="1" Background="{DynamicResource ThemeTitleBarBackground}" BorderBrush="{DynamicResource ThemeTitleBarBorder}" BorderThickness="0,0,0,1">
			<Grid MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="Auto" />
				</Grid.ColumnDefinitions>
				<Image Source="/RevitPythonShell;component/Resources/Console-16.png" Width="16" Height="16" Margin="10,0,6,0" VerticalAlignment="Center" />
				<TextBlock Grid.Column="1" VerticalAlignment="Center" Foreground="{DynamicResource ThemeTitleBarForeground}" Text="{Binding Title, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
				<Button Grid.Column="2" x:Name="minimizeButton" Style="{StaticResource TitleBarButtonStyle}" Click="MinimizeButton_Click" Content="&#xE921;" />
				<Button Grid.Column="3" x:Name="maximizeButton" Style="{StaticResource TitleBarButtonStyle}" Click="MaximizeButton_Click" Content="&#xE922;" />
				<Button Grid.Column="4" x:Name="closeButton" Style="{StaticResource TitleBarCloseButtonStyle}" Click="CloseButton_Click" Content="&#xE8BB;" />
			</Grid>
		</Border>


	</Grid>
</Window>